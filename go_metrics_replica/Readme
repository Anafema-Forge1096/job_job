Cкрипт на go для подключения к БД и вытаскивания оттуда из таблицы запросами данных с преобразованием в метрики прометея
Job для прометея, выглядит примерно так:
  - job_name: 'custom_replica_check'
    scrape_interval: 120s
    scrape_timeout: 60s
    static_configs:
      - targets:
        - dc1-nsud-db:9188
    metric_relabel_configs:             # Для удаления ненужных системных метрик и вывода только требующихся
      - source_labels: [__name__]
        regex: 'logical_replication_.*'
        action: keep
